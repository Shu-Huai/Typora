# screen 命令

`screen` 是一个在 Linux/Unix 系统中广泛使用的**终端复用工具**，允许用户在一个终端窗口中创建多个虚拟终端会话，并支持会话的**断开与恢复**。它特别适合管理长时间运行的任务或远程服务器操作，避免因网络中断导致任务终止。

## 核心功能

1. **会话持久化**

    即使终端断开（如 SSH 连接中断），会话中的进程仍会在后台运行，后续可随时重新连接。

2. **多窗口管理**

    支持创建多个终端窗口，并通过快捷键切换。

3. **窗口分割**

    将屏幕垂直或水平分割，同时查看多个会话（需较新版本支持）。

4. **协作共享**

    允许多个用户同时连接同一会话，实时协作（如远程调试）。

## 基础用法

### 启动新会话

```bash
screen                    # 创建匿名会话
screen -S <session_name>  # 创建命名会话（推荐，便于管理）
```

### 分离会话（后台运行）

- 快捷键：`Ctrl + A` → `D`

    会话会保持运行，可退出终端或断开连接。

### 恢复会话

```bash
screen -ls                   # 查看所有会话列表
screen -r <session_id/name>  # 恢复指定会话
```

### 窗口管理

- **新建窗口**：`Ctrl + A` → `C`
- **切换窗口**：`Ctrl + A` → `数字键` 或 `N`（下一个）/`P`（上一个）
- **关闭窗口**：输入 `exit` 或 `Ctrl + D`

### 滚动与复制

- **进入滚动模式**：`Ctrl + A` → `[`
    使用方向键或 `PgUp/PgDown` 滚动，按 `Esc` 退出。
- **复制文本**：在滚动模式下选中文本，按 `Enter` 复制，粘贴用 `Ctrl + A` → `]`。

## 高级操作

### 窗口分割（需支持）

- **水平分割**：`Ctrl + A` → `S`
- **垂直分割**：`Ctrl + A` → `|`（需配置）
- **切换分屏区域**：`Ctrl + A` → `Tab`

### 会话共享

```bash
# 用户A创建会话
screen -S shared_session
# 用户B加入同一会话
screen -x shared_session
```

### 日志记录

```bash
screen -L -S <session_name>  # 自动记录会话日志到文件 screenlog.0
```

## 常用命令

| 命令                       | 说明         |
| -------------------------- | ------------ |
| `screen -ls`               | 列出所有会话 |
| `screen -r <name>`         | 恢复会话     |
| `screen -X -S <name> quit` | 强制关闭会话 |
| `screen -d <name>`         | 远程分离会话 |

## 安装方法

```bash
sudo apt install screen
```

## 适用场景

- 运行长时间任务（如编译、下载）。
- 通过 SSH 管理远程服务器，防止网络中断导致任务终止。
- 多任务并行处理（编译代码的同时监控日志）。
- 团队协作调试或教学演示。
