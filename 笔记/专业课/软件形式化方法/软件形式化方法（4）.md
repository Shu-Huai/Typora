# 软件形式化方法（4）

## 规格说明的实例

### 简介

#### 模式语言和数学语言

一阶逻辑、集合论、类型、关系、函数、序列和包等都属于数学语言

公理定义、模式、通用式模式等都属于模式语言

- 操作系统中的存储管理
- 图书馆数据库管理
- 命题演算的证明器

### 存储分配管理

#### 系统状态描述

设存储块的集合为 $B$，它含有 $n$ 个连续的以自然数来标记的块

<img src="http://public.file.lvshuhuai.cn/images\image-20241222134110418.png" alt="image-20241222134110418" style="zoom:50%;" />

用户的集合为 $U$，因此 $U$ 是一个给定类型

存储管理程序中含有一个目录 $dir$​，它记录了哪个用户使用着哪些存储块。

- 每一个块只能由一个用户占用。
- 一个用户可以占用多个存储块。
- 某些块可能还未被占用。
- 某些用户没有占用任何块。

可将 $dir$ 表示为一个 $B$ 到 $U$ 的函数，并以它来形式地描述上述性质。因此，$dir$ 必须满足如下性质。

- $dir$ 是一个函数符。
- $dir$ 不必是一个入射函数。
- $dir$ 可以是一个部分函数。
- $dir$​ 不必是一个满射函数。

$dir:B\rightharpoonup  U$​

一个分量来记录哪一个块是自由的，即未被任何人占用的存储块。这个分量就是 $B$ 的一个子集 $free:\mathbb P B$

$free=B\backslash(\mathbf{dom}dir)$

<img src="http://public.file.lvshuhuai.cn/images\image-20241222134819258.png" alt="image-20241222134819258" style="zoom:50%;" />

<img src="http://public.file.lvshuhuai.cn/images\image-20241222134839286.png" alt="image-20241222134839286" style="zoom:50%;" />

<img src="http://public.file.lvshuhuai.cn/images\image-20241222134908573.png" alt="image-20241222134908573" style="zoom:50%;" />

<img src="http://public.file.lvshuhuai.cn/images\image-20241222134932852.png" alt="image-20241222134932852" style="zoom:50%;" />

<img src="http://public.file.lvshuhuai.cn/images\image-20241222134945529.png" alt="image-20241222134945529" style="zoom:50%;" />

#### 请求分配空闲存储块的操作

设该操作的输入变量为一个用户名 $u?$，输出变量为一个存储块 $b!$ 和一个回答 $r!$。

<img src="http://public.file.lvshuhuai.cn/images\image-20241222135030269.png" alt="image-20241222135030269" style="zoom:50%;" />

$free\ne \lbrace\rbrace$

$b!\in free$

