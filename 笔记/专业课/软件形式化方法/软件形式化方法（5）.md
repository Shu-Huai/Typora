# 软件形式化方法（5）

## Z 规格说明的形式推理

### 问题的提出和有关的概念

#### 一个关于“学生兴趣小组”的规格说明

$$
[Person]
$$

<img src="http://public.file.lvshuhuai.cn/images\image-20241227121154937.png" alt="image-20241227121154937" style="zoom:50%;" />
$$
\Delta lniteGroup\hat{=}lniteGroup\land IniteGroup'
$$

$$
\Xi IniteGroup\hat{=}\Delta IniteGroup|s'=s
$$

<img src="http://public.file.lvshuhuai.cn/images\image-20241229140703085.png" alt="image-20241229140703085" style="zoom:50%;" />

<img src="http://public.file.lvshuhuai.cn/images\image-20241227121446358.png" alt="image-20241227121446358" style="zoom:50%;" />

<img src="http://public.file.lvshuhuai.cn/images\image-20241227121524671.png" alt="image-20241227121524671" style="zoom:50%;" />

<img src="http://public.file.lvshuhuai.cn/images\image-20241229141112929.png" alt="image-20241229141112929" style="zoom:50%;" />

$$
EnterGroup;Leavegroup\vdash \text{\#}s<Max\land\text{\#}s'<Max\land s'=s
$$
当规格说明的一个性质被“证明”是成立的，就可将其称为一个定理。

#### 规格说明中的定理表示形式

一个定理必须要有一个与之对应的证明。当写 $H\vdash C$ 时，仅仅是断言，如果有 $H$ 则可证明 $C$，但这仅是一个推测。

如果在符号左边没有出现前提，可把它的结论看成是一个定理，该结论表示，在当前环境下，该定理不需要前提。

谓词部分可以为空

在符号左边，说明和谓词都可出现，但其右边的结论必须是谓词。

#### 模式作为谓词

在符号的右边引用了一个模式，那么这个模式就解释为一个谓词

模式中声明的变量必须在规格说明的作用域内，即它们必须是在前提中引入，或者是全程变量。

### 关于严密证明

#### 关于集合的推理

对集合进行推理的例子

#### 归纳法证明

数学归纳法是一个推理规则，能够证明对所有的非负整数某些确定的性质是成立的。

### 一个定律库

<img src="http://public.file.lvshuhuai.cn/images\image-20241229150327371.png" alt="image-20241229150327371" style="zoom:50%;" />

<img src="http://public.file.lvshuhuai.cn/images\image-20241229150358778.png" alt="image-20241229150358778" style="zoom:50%;" />

<img src="http://public.file.lvshuhuai.cn/images\image-20241229150406608.png" alt="image-20241229150406608" style="zoom:50%;" />

<img src="http://public.file.lvshuhuai.cn/images\image-20241230180850743.png" alt="image-20241230180850743" style="zoom:50%;" />

<img src="http://public.file.lvshuhuai.cn/images\image-20241230180841987.png" alt="image-20241230180841987" style="zoom:50%;" />

<img src="http://public.file.lvshuhuai.cn/images\image-20241230180803643.png" alt="image-20241230180803643" style="zoom:50%;" />

### 关于规格说明的推理

#### 引入一个“球迷身份卡”

$$
[PERSON,ID]
$$

<img src="http://public.file.lvshuhuai.cn/images\image-20241230181047582.png" alt="image-20241230181047582" style="zoom:50%;" />

<img src="http://public.file.lvshuhuai.cn/images\image-20241230181106649.png" alt="image-20241230181106649" style="zoom:50%;" />

#### 初始化定理及其证明

<img src="http://public.file.lvshuhuai.cn/images\image-20241230181245315.png" alt="image-20241230181245315" style="zoom:50%;" />
$$
\vdash\exists Fid'\cdot InitFid
$$

#### 前置条件及其简化

**前置条件的计算**

<img src="http://public.file.lvshuhuai.cn/images\image-20241230181617281.png" alt="image-20241230181617281" style="zoom:50%;" />

<img src="http://public.file.lvshuhuai.cn/images\image-20241230185245902.png" alt="image-20241230185245902" style="zoom:50%;" />



**前置条件的简化**

先展开谓词部分

<img src="http://public.file.lvshuhuai.cn/images\image-20250108230559259.png" alt="image-20250108230559259" style="zoom:50%;" />

应用点规则

<img src="http://public.file.lvshuhuai.cn/images\image-20250108230634484.png" alt="image-20250108230634484" style="zoom:50%;" />

删除冗余合取项

<img src="http://public.file.lvshuhuai.cn/images\image-20250108230823041.png" alt="image-20250108230823041" style="zoom:50%;" />

化简

<img src="http://public.file.lvshuhuai.cn/images\image-20250108230939278.png" alt="image-20250108230939278" style="zoom:50%;" />

<img src="http://public.file.lvshuhuai.cn/images\image-20250108231011656.png" alt="image-20250108231011656" style="zoom:50%;" />

<img src="http://public.file.lvshuhuai.cn/images\image-20250108231251824.png" alt="image-20250108231251824" style="zoom:50%;" />

前置条件的简化也是一个定理证明的问题

<img src="http://public.file.lvshuhuai.cn/images\image-20250108231347082.png" alt="image-20250108231347082" style="zoom:50%;" />

#### 规格说明的性质及其证明

**描述规格说明性质的定理**

<img src="http://public.file.lvshuhuai.cn/images\image-20250108232228744.png" alt="image-20250108232228744" style="zoom:50%;" />

若禁止一个已被禁止观看球赛的人看球赛， 则系统的状态不变

<img src="http://public.file.lvshuhuai.cn/images\image-20250108232243773.png" alt="image-20250108232243773" style="zoom:50%;" />

<img src="http://public.file.lvshuhuai.cn/images\image-20250108232457602.png" alt="image-20250108232457602" style="zoom:50%;" />

**证明一个规格说明的性质**

<img src="http://public.file.lvshuhuai.cn/images\image-20250108234532203.png" alt="image-20250108234532203" style="zoom:50%;" />

#### 关于精化定理的证明

将一个抽象的规格说明变换为一个可执行程序的过程就叫做精化

要确信一个程序是一个规格说明的精化的结果，必须证明这个程序是规格说明的实现

## Z 规格说明的若干推理实例

### 两个初始化定理的证明

#### 存储管理程序的规格说明中的初始化定理

展开定理

消除 $|$

应用点规则

<img src="http://public.file.lvshuhuai.cn/images\image-20250109002757104.png" alt="image-20250109002757104" style="zoom:50%;" />

得到了证明

#### 图书馆数据库DB 的初始化定理

<img src="http://public.file.lvshuhuai.cn/images\image-20250109002828344.png" alt="image-20250109002828344" style="zoom:50%;" />

展开定理

消除 $|$

应用点规则

<img src="http://public.file.lvshuhuai.cn/images\image-20250109002904164.png" alt="image-20250109002904164" style="zoom:50%;" />

得到了证明

### 两个前置条件的简化

#### 存储管理程序中一个前置条件的简化

<img src="http://public.file.lvshuhuai.cn/images\image-20250109002943914.png" alt="image-20250109002943914" style="zoom:50%;" />

展开模式

应用点规则

处理合取项

<img src="http://public.file.lvshuhuai.cn/images\image-20250109003033914.png" alt="image-20250109003033914" style="zoom:50%;" />

#### 正文编辑程序中的一个前置条件的简化

<img src="http://public.file.lvshuhuai.cn/images\image-20250109003242609.png" alt="image-20250109003242609" style="zoom:50%;" />

展开谓词部分

应用点规则

处理合取项

<img src="http://public.file.lvshuhuai.cn/images\image-20250109003322240.png" alt="image-20250109003322240" style="zoom:50%;" />

### 规格说明中一般定理的证明

#### 正文编辑程序中的一个定理

<img src="http://public.file.lvshuhuai.cn/images\image-20250109003351962.png" alt="image-20250109003351962" style="zoom:50%;" />

#### 图书馆数据库管理系统中的一个定理

<img src="http://public.file.lvshuhuai.cn/images\image-20250109003406335.png" alt="image-20250109003406335" style="zoom:50%;" />

## 从规格说明到程序

### 程序范畴与软件精化

#### 程序范畴

![image-20250109153921024](Z:\Public\images\image-20250109153921024.png)

放弃传统观点中“程序可以由计算机直接执行”的观点，较之传统观点，“程序”一词的内涵有所增加

#### 软件精化



#### 岗哨命令语言
